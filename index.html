<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feedstadon</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="images/icon-192.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/showdown/dist/showdown.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }).catch(err => {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</head>
<body>
    <div id="app-container">
        <div id="timeline-view" class="view active"></div>
        <div id="lemmy-timeline-view" class="view"></div>
        <div id="notifications-view" class="view"></div>
        <div id="post-detail-view" class="view"></div>
        <div id="lemmy-post-view" class="view"></div>
        <div id="profile-page-view" class="view"></div>
        <div id="search-view" class="view"></div>
        <div id="discover-view" class="view"></div>
        <div id="conversations-view" class="view"></div>
        <div id="settings-view" class="view"></div>
        <div id="screenshot-view" class="view"></div>
        <div id="edit-profile-view" class="view"></div>
        <div id="lemmy-community-view" class="view"></div>

        <div id="login-view" class="view">
             <img src="images/logo.png" alt="Feedstadon Logo" class="login-logo">
            <div class="login-container">
                <h2>Login to your Mastodon Instance</h2>
                <input type="text" id="instance-url" placeholder="your.mastodon.instance">
                <button id="login-btn">Login</button>
            </div>
        </div>
    </div>
    
    <div id="compose-modal" class="modal-container">
        <div class="modal-content">
            <div class="modal-header">
                <h3>New Post</h3>
                <button class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="replying-to-container" style="display: none;"></div>
                <textarea class="compose-textarea" placeholder="What's on your mind?"></textarea>
            </div>
            <div class="modal-footer">
                <div class="compose-actions">
                    <button id="compose-add-media"></button>
                    <button id="compose-add-poll"></button>
                    <button id="compose-cw"></button>
                </div>
                <button class="compose-submit-btn button-primary">Post</button>
            </div>
        </div>
    </div>

    <div id="image-modal" class="modal-container">
         <span class="close-btn">&times;</span>
         <img class="modal-content" id="modal-image-content">
    </div>

    <div id="help-modal" class="modal-container">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Help</h3>
                <button id="close-help-btn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p>Feedstadon is a client for Mastodon and Lemmy.</p>
                <p>Double-click/tap a post to view its detail page.</p>
                <p>Long-press on a post to open a context menu with more options.</p>
            </div>
        </div>
    </div>

    <div id="toast-notification"></div>
    <div id="context-menu" class="context-menu" style="display: none;"></div>
    <div id="scroll-loader" style="display: none;"></div>
    <div id="pull-to-refresh-indicator"></div>

    <nav id="nav-bar" style="display: none;">
        <button class="nav-button active" data-view="timeline-view" aria-label="Home"></button>
        <button class="nav-button" data-view="lemmy-timeline-view" aria-label="Lemmy"></button>
        <button class="nav-button" data-view="notifications-view" aria-label="Notifications"><span id="notification-badge" class="badge" style="display:none;"></span></button>
        <button class="nav-button" data-view="discover-view" aria-label="Discover"></button>
        <button class="nav-button" data-view="conversations-view" aria-label="Messages"></button>
        <button class="nav-button" data-view="settings-view" aria-label="Settings"></button>
    </nav>
    
    <template id="screenshot-controls-template">
        <div id="screenshot-controls">
            <button id="capture-btn" class="button">Download Screenshot</button>
        </div>
    </template>

    <script type="module" src="app.js"></script>
</body>
</html>
