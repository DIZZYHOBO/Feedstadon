<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Feedstodon</title>
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#1D1E1F">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="./images/logo.png" type="image/png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
</head>
<body>

    <nav class="top-nav" style="display: none;">
        <div class="nav-left">
            <button class="nav-button icon-button" id="notifications-btn" title="Notifications"></button>
            <button class="nav-button icon-button" id="refresh-btn" title="Refresh Feed"></button>
            <div class="dropdown" id="feeds-dropdown">
                <button class="nav-button">Feeds</button>
                <div class="dropdown-content">
                    <a href="#" data-timeline="home" class="main-feed-link">Home</a>
                    <a href="#" id="lemmy-main-link">Lemmy</a>
                    <a href="#" id="mastodon-main-link">Mastodon</a>
                </div>
            </div>
        </div>
        
        <div class="nav-center">
            <svg id="nav-logo" xmlns="http://www.w3.org/2000/svg" width="1280" height="426" viewBox="0 0 1280 426"><path d="m961 28 38.438-.062 12.154-.028c4.883-.005 4.883-.005 7.166-.005q2.401-.003 4.802-.01 3.63-.01 7.258-.009l2.175-.01c4.893.01 4.893.01 6.007 1.124.098 2.002.124 4.007.123 6.01l.006 3.986-.009 4.437q0 2.333.003 4.667.002 6.445-.007 12.889-.005 6.938-.002 13.875 0 12.03-.008 24.06-.011 17.395-.012 34.788-.004 28.218-.019 56.435-.014 27.419-.02 54.836v3.412l-.005 16.943q-.016 70.331-.05 140.662h-68c-2.25-13.5-2.25-13.5-3-19l-2.098 1.688c-22.69 17.698-48.365 24.885-77.078 21.812-10.146-1.27-19.398-3.445-28.824-7.5l-2.586-1.082c-26.413-12.095-44.279-36.979-54.601-63.418-12.876-35.241-15.781-75.718-8.813-112.5l.438-2.337c4.408-22.641 14.679-44.06 29.562-61.663l1.902-2.324c16.393-19.515 40.37-31.718 65.598-34.301 24.474-1.877 45.553 4.156 66.5 16.625l2 2zm-71 172-2.305 2.148c-16.448 16.67-18.883 40.914-18.88 63.178-.002 2.208-.02 4.414-.04 6.621-.053 12.943.53 26.062 4.913 38.366l.793 2.279c5.282 14.504 14.647 25.665 28.66 32.35 10.24 3.79 24.262 3.728 34.316-.622 3.706-1.924 7.261-3.909 10.67-6.327C951 336 951 336 953.674 334.595c4.218-2.722 6.768-5.184 7.905-10.087.997-8.009.797-16.082.715-24.137q.006-3.954.022-7.908c.013-5.515-.014-11.03-.066-16.545-.06-6.36-.05-12.717-.006-19.077.042-6.142.032-12.282 0-18.423q-.013-3.905.014-7.809a537 537 0 0 0-.077-10.92l.05-3.242c-.119-4.462-.32-7.325-3.187-10.861A69 69 0 0 0 952 200l-1.86-1.309C931.582 186.457 907.103 183.654 890 200M30 28l122.438-.062 38.732-.028c15.547-.005 15.547-.005 22.814-.005q7.65-.002 15.302-.01 9.74-.011 19.479-.008 3.585 0 7.174-.006 4.82-.006 9.64-.001l2.879-.01c6.428.016 6.428.016 7.542 1.13.1 2.173.128 4.349.13 6.523l.005 2.065q.004 3.394-.002 6.787 0 2.349.003 4.697.001 4.927-.006 9.856-.006 6.33.004 12.661.005 4.851 0 9.702 0 2.336.002 4.67.003 3.258-.007 6.516l-.002 3.752C276 99 276 99 275 100c-2.088.097-4.18.122-6.27.12l-2.008.003q-3.352.001-6.707-.01l-4.788.001q-6.52-.001-13.04-.013-6.808-.007-13.614-.008-12.9-.005-25.797-.021-17.422-.018-34.846-.024c-18.31-.01-36.62-.03-54.93-.048v74h121c1.125 13.5 1.125 13.5 1.114 18.687v3.516l-.016 3.656-.005 3.85q-.007 5.001-.024 10.002-.014 5.128-.02 10.258-.017 10.015-.049 20.031-12.343.203-24.686.391-5.742.087-11.484.182c-28.61.472-57.216.483-85.83.427l.003 2.478q.033 29.805.049 59.611.007 14.415.023 28.828.015 12.56.02 25.119 0 6.652.01 13.306.01 6.258.008 12.514 0 2.302.006 4.603.006 3.132.001 6.264l.003 3.548C113 404 113 404 112 406H30zm700.457 125.547C755.979 177.575 769.302 210.313 771 245c.146 5.862.145 11.725.13 17.588q-.005 4.048.007 8.096 0 2.572-.004 5.144l.006 2.446c-.024 5.611-.024 5.611-1.139 6.726-2.025.109-4.053.147-6.08.158l-1.946.015c-2.167.016-4.333.024-6.5.032l-4.64.03q-6.32.04-12.638.068c-4.398.022-8.795.05-13.193.076q-12.5.074-25 .138-14.228.076-28.454.16-29.274.17-58.549.323.935 5.787 1.883 11.57l.53 3.295c2.603 15.826 7.252 29.533 20.774 39.26 10.943 6.937 23.496 7.318 36.067 5.371A61 61 0 0 0 680 343l2.43-.926C694.9 336.596 706.542 325.188 714 314c5.873.426 9.606 2.963 14.375 6.125l5.047 3.266 2.713 1.763c6.119 3.942 12.32 7.752 18.503 11.593A548 548 0 0 1 772 348c-.762 4.678-2.57 7.545-5.5 11.188l-1.357 1.72c-4.165 5.23-8.56 10.224-13.143 15.092l-1.883 2.078c-15.741 16.73-38.25 25.642-60.305 30.172l-2.409.495c-32.31 6.208-69.95 3.744-97.821-14.905-27.39-19.517-42.896-46.621-50.395-79.027l-.59-2.55c-3.166-14.609-3.975-28.996-3.91-43.888l.007-2.665c.053-13.424.471-26.54 3.306-39.71l.602-2.833C541.566 209.71 545.823 197.309 552 185l1.34-2.723c12.44-23.75 34.079-42.342 59.285-51.214 40.907-12.382 85.688-6.977 117.832 22.484m-105.145 43.14C618.296 205.268 613 217.776 613 229h84c-1.233-13.561-4.97-25.742-15.25-35.25-16.368-13.058-41.864-12.641-56.438 2.938M398.98 124.879c31.797-.672 57.937 9.353 81.02 31.121l2.05 1.855c6.331 5.95 11.157 12.946 15.95 20.145l1.91 2.867C520.22 213.53 518 246.731 518 285H360c4.75 32.052 4.75 32.052 24 56 11.967 6.713 27.255 6.81 40.375 3.563 15.328-5.14 27.931-17.954 37.625-30.563 5.16.516 8.847 3.107 13.125 5.813l2.38 1.48c2.504 1.56 5 3.132 7.495 4.707l2.438 1.533q5.958 3.749 11.902 7.518C506.205 339.4 513.103 343.7 520 348c-.598 2.997-1.482 4.986-3.3 7.434l-1.444 1.946-1.568 2.058-1.63 2.143c-22.905 29.71-51.452 43.44-88.222 48.888-2.956.314-5.864.45-8.836.531l-2.493.078c-32.888.909-63.246-4.52-88.167-27.39-8.52-8.064-15.502-16.514-21.34-26.688l-1.08-1.876c-23.996-42.656-25.518-98.51-12.607-144.783C297.351 182.947 313.395 157.323 338 142l2.277-1.54c17.233-11.182 38.521-14.761 58.703-15.581m-25.921 71.09c-8.184 9.756-10.397 20.61-13.059 33.031h85c-2.241-14.568-5.273-27.579-17.422-36.848-2.47-1.56-4.943-2.893-7.578-4.152l-2.04-1.027c-14.696-6.157-33.884-2.177-44.901 8.996m882.05-41.646c5.92 5.25 11.413 10.973 16.891 16.677-1.745 3.765-3.822 5.912-6.938 8.687l-1.48 1.325c-3.247 2.88-6.578 5.639-9.957 8.363-4.203 3.389-8.186 6.939-12.125 10.625-4.129 3.842-8.278 7.644-12.563 11.312l-2.597 2.239c-2.34 1.449-2.34 1.449-4.285 1.231-2.408-.916-3.524-1.961-5.27-3.845l-1.81-1.903-1.913-2.034c-11.13-11.447-22.814-20.938-39.437-21.5-8.011.245-17.9 1.117-23.875 7.125-2.658 5.127-3.579 9.9-2.223 15.586 2.508 6.033 6.88 8.788 12.473 11.789l1.726.939c12.429 6.638 25.613 11.2 38.916 15.724 12.036 4.103 23.962 8.471 34.92 15.024l2.145 1.28c20.045 12.294 32.683 30.028 38.293 53.033 5.003 21.956 2.777 44.66-9 64-2.468 3.537-5.115 6.797-8 10l-1.605 1.852c-18.724 20.248-47.477 27.86-74.068 29.292-35.772 1.285-69.354-8.228-95.908-32.866-8.147-7.723-17.052-16.334-22.419-26.278.257-2.546.68-3.688 2.524-5.485l1.992-1.406 2.262-1.626 2.472-1.733a3250 3250 0 0 0 5.195-3.738l2.751-1.975c4.701-3.415 9.315-6.944 13.929-10.475l2.58-1.967 2.49-1.904 2.42-1.835a153 153 0 0 0 4.825-3.919l2.365-1.972 2.085-1.797c2.11-1.168 2.11-1.168 4.736-1.004 3.474 1.223 4.615 3.337 6.686 6.336q1.184 1.653 2.375 3.3L1129 324c9.11 11.664 23.144 22.874 38 26 12.432.752 23.467.805 33.562-7.438 4.376-4.241 5.503-7.401 5.813-13.437-.142-4.792-.988-8.59-4.375-12.125-6.608-4.68-13.971-7.99-21.375-11.188l-3.253-1.424c-6.924-2.997-13.91-5.783-20.958-8.473-27.616-10.55-60.655-24.129-74.164-52.353-8.789-20.44-9.422-45.793-1.469-66.606 8.485-20.726 24.714-35.226 45.06-44.088 42.6-17.129 94.563-7.885 129.268 21.455"/>
            <form id="search-form" style="display: none;">
                <input type="search" id="search-input" placeholder="Search accounts and hashtags..." autocomplete="off">
                <div id="search-suggestions-container"></div>
            </form>
        </div>

        <div class="nav-right">
            <button class="nav-button" id="search-toggle-btn">Search</button>
            <div class="dropdown" id="user-dropdown">
                <button class="nav-button" id="user-display-btn">Menu</button>
                <div class="dropdown-content">
                    <a href="#" id="new-post-link">New Post</a>
                    <a href="#" id="profile-link">Profile</a>
                    <a href="#" id="settings-link">Settings</a>
                    <a href="#" id="logout-link">Logout</a>
                </div>
            </div>
        </div>
    </nav>
    <div id="loading-bar"></div>

    <div class="container">
        <div id="pull-to-refresh-indicator">Release to refresh</div>
        <div id="refresh-spinner"></div>
        <div id="app-view">
            <div id="timeline-sub-nav" class="timeline-sub-nav"></div>
            <div id="timeline"></div>
            <div id="notifications-view" style="display: none;">
                <div class="notifications-sub-nav"></div>
                <div id="notifications-list"></div>
            </div>
            <div id="profile-page-view" style="display: none;">
                 <div class="profile-tabs">
                    <button class="tab-button" data-profile-tab="mastodon">Mastodon</button>
                    <button class="tab-button" data-profile-tab="lemmy">Lemmy</button>
                </div>
                <div class="profile-tab-content" id="mastodon-profile-content"></div>
                <div class="profile-tab-content" id="lemmy-profile-content"></div>
            </div>
            <div id="edit-profile-view" style="display: none;"></div>
            <div id="edit-post-view" style="display: none;"></div>
            <div id="search-results-view" style="display: none;"></div>
            <div id="status-detail-view" style="display: none;"></div>
            <div id="settings-view" style="display: none;"></div>
            <div id="lemmy-post-view" style="display: none;"></div>
            <div id="scroll-loader"><p></p></div>
        </div>
    </div>
    
    <template id="login-prompt-template">
        <div class="login-prompt-container">
            <div class="login-prompt-form-container">
                <div class="login-form-section" id="mastodon-login-section">
                     <h4>Log in to Mastodon</h4>
                     <form class="mastodon-login-form">
                        <input type="text" class="instance-url" placeholder="your-instance.social">
                        <input type="password" class="access-token" placeholder="Paste your access token">
                        <button type="submit" class="connect-btn">Log In</button>
                    </form>
                </div>
                <div class="login-form-section" id="lemmy-login-section">
                    <h4>Log in to Lemmy</h4>
                    <form class="lemmy-login-form">
                        <input type="text" class="lemmy-instance-input" value="leminal.space">
                        <input type="text" class="lemmy-username-input" placeholder="Your Lemmy Username">
                        <input type="password" class="lemmy-password-input" placeholder="Your Lemmy Password">
                        <button type="submit" class="connect-btn">Log In</button>
                    </form>
                </div>
            </div>
        </div>
    </template>

    <div id="compose-modal" class="modal-overlay">
       <div class="modal-content">
            <div class="compose-tabs">
                <button class="tab-button active" data-tab="mastodon">Mastodon</button>
                <button class="tab-button" data-tab="lemmy">Lemmy</button>
            </div>
            
            <div class="compose-tab-content active" id="mastodon-compose-tab">
                <form id="mastodon-compose-form">
                    <div id="cw-creator-container" style="display: none;">
                        <input type="text" id="spoiler-text-input" placeholder="Content Warning (e.g., spoilers, politics)">
                    </div>
                    <textarea id="compose-textarea" placeholder="What's on your mind?"></textarea>
                    <div id="poll-creator-container" style="display: none;">
                        <div id="poll-options-container">
                            <input type="text" class="poll-option-input" placeholder="Choice 1" maxlength="25">
                            <input type="text" class="poll-option-input" placeholder="Choice 2" maxlength="25">
                        </div>
                        <button type="button" id="add-poll-option-btn" class="button-secondary">Add Choice</button>
                        <div class="poll-settings">
                            <div class="form-group"><label for="poll-duration-select">Poll duration</label><select id="poll-duration-select"><option value="300">5 minutes</option><option value="1800">30 minutes</option><option value="3600">1 hour</option><option value="21600">6 hours</option><option value="86400" selected>1 day</option><option value="259200">3 days</option><option value="604800">7 days</option></select></div>
                            <div class="form-group"><label><input type="checkbox" id="poll-multiple-choice-check"> Multiple choices</label></div>
                        </div>
                    </div>
                    <div class="modal-actions">
                        <div class="compose-options">
                            <input type="file" id="media-attachment-input" accept="image/*,video/*,image/svg+xml" style="display: none;"><button type="button" id="add-media-btn" class="button-secondary icon-button" title="Add Media"></button><button type="button" id="add-poll-btn" class="button-secondary icon-button" title="Add Poll"></button><button type="button" id="add-cw-btn" class="button-secondary icon-button" title="Add Content Warning"></button><span id="media-filename-preview"></span>
                        </div>
                        <div><button type="button" class="button-secondary cancel-compose-btn">Cancel</button><button type="submit">Post</button></div>
                    </div>
                </form>
            </div>

            <div class="compose-tab-content" id="lemmy-compose-tab">
                <form id="lemmy-compose-form">
                    <input type="text" id="lemmy-title-input" placeholder="Title (required)" required>
                    <input type="text" id="lemmy-community-input" placeholder="Community (e.g., !main@lemmy.world)" required>
                    <div class="lemmy-post-type-selector">
                        <button type="button" class="lemmy-post-type-btn active" data-type="Text">Text</button>
                        <button type="button" class="lemmy-post-type-btn" data-type="Link">Link</button>
                        <button type="button" class="lemmy-post-type-btn" data-type="Image">Image</button>
                    </div>
                    <div id="lemmy-link-input-container" style="display: none;">
                        <input type="url" id="lemmy-url-input" placeholder="https://example.com">
                    </div>
                    <div id="lemmy-image-input-container" style="display: none;">
                        <input type="file" id="lemmy-image-input" accept="image/*">
                        <span id="lemmy-image-preview"></span>
                    </div>
                    <textarea id="lemmy-body-textarea" placeholder="Body (optional)"></textarea>
                    <div class="modal-actions">
                        <div><button type="button" class="button-secondary cancel-compose-btn">Cancel</button><button type="submit">Post</button></div>
                    </div>
                </form>
            </div>

        </div>
    </div>

    <div id="logout-modal" class="modal-overlay">
       <div class="modal-content">
            <h3>Logout</h3>
            <p>Choose which account to log out from.</p>
            <div class="logout-options">
                <button id="mastodon-logout-btn" class="button-secondary">Mastodon Logout</button>
                <button id="lemmy-logout-btn" class="button-secondary">Lemmy Logout</button>
            </div>
            <div class="modal-actions">
                <button id="cancel-logout-btn" class="button-secondary">Cancel</button>
                <button id="logout-all-btn" class="button-danger">Logout All</button>
            </div>
        </div>
    </div>
    
    <div id="image-modal" class="modal-overlay">
        <div class="image-modal-content">
            <img id="fullscreen-image" src="">
            <button id="save-image-btn" class="icon-button"></button>
        </div>
    </div>

    <div id="context-menu"></div>

    <div id="toast-notification"></div>

    <script type="module" src="app.js"></script>
</body>
</html>
